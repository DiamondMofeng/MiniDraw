
***仅为思路，实际实现过程偷懒了***

---

思路1：
画笔对象，使用按钮切换当前笔触类型

画布分为两层，一层是画布，一层是当前预览
画布层用栈储存历史记录，每次撤销时退出栈顶元素，然后(？遍历历史笔触重新绘图？)

画笔正在画时，在预览层显示预览
收笔后，将本次绘制结果 推入画布层栈顶，然后重新渲染画布层


思路2：
画笔对象，使用按钮切换当前笔触类型

画布仅分为一层，仍然用栈储存。

落笔后新建一个绘画痕迹对象，当此对象存在时，渲染画布层对应位置。


=======================================

# 实现方案  

## 1. 初始化画布  

因为要获取到真实的canvas dom对象，所以不能直接用react的函数式组件。 
这里创建了一个类组件，仅渲染一个canvas，然后用ref获取到canvas dom对象。 
后续便可以直接对其进行操作。

## 2. 创建画笔对象，方便读取MouseEvent

需要得到？  

- 直线  
  仅需得到起点坐标，终点坐标；  
- （椭）圆形  
  仅需得到起点坐标，终点坐标，剩余参数可以据此推断；
- 矩形  
  仅需得到起点坐标，终点坐标，剩余参数可以据此推断；
- 连续折线  
  需要得到起点坐标，后续各点坐标，以及确认一个中止方法；
- 自由绘制  
  从第一次点击后开始，连续记录鼠标位置，直到发出中止命令；

如何获取：

- 按下时坐标  
  使用mousedown方法 
- 松开按键时坐标  
  使用mouseup方法

实现原理：

**注意,使用 window.oncontextmenu 回调函数禁用了浏览器右键弹出菜单的默认功能，方便后续使用右键作为停止指令**

- 直线、圆形、矩形  
  鼠标按下时开始，鼠标松开时结束。  
- 连续折线  
  鼠标第一次按下时开始，每次按下时进行绘制。点击右键后结束（不包括右键这个点）
- 自由绘制  
  鼠标按下时开始，鼠标松开时结束。



